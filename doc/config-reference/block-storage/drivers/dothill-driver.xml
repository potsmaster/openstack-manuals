<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="dothill-driver"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:ns5="http://www.w3.org/1999/xhtml"
         xmlns:ns4="http://www.w3.org/1998/Math/MathML"
         xmlns:ns3="http://www.w3.org/2000/svg"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>Dot Hill AssuredSAN Fibre Channel and iSCSI drivers</title>

  <para>The <filename>DotHillFCDriver</filename> and
  <filename>DotHillISCSIDriver</filename> Cinder drivers allow Dot Hill arrays
  to be used for block storage in OpenStack deployments.</para>

  <simplesect xml:id="dothill-sys-reqs">
    <title>System requirements</title>

    <para>To use the Dot Hill drivers, the following are required:</para>

    <itemizedlist>
      <listitem>
        <para>Dot Hill AssuredSAN array with:</para>

        <itemizedlist>
          <listitem>
            <para>iSCSI or FC host interfaces</para>
          </listitem>

          <listitem>
            <para>G22x firmware or later</para>
          </listitem>

          <listitem>
            <para>Appropriate licenses for the snapshot and copy volume
            features</para>
          </listitem>
        </itemizedlist>
      </listitem>

      <listitem>
        <para>Network connectivity between the OpenStack host and the array
        management interfaces</para>
      </listitem>

      <listitem>
        <para>HTTPS or HTTP must be enabled on the array</para>
      </listitem>
    </itemizedlist>
  </simplesect>

  <simplesect xml:id="dothill-supported-ops">
    <title>Supported operations</title>
        <itemizedlist>
          <listitem>
            <para>Create, delete, attach, and detach volumes.</para>
          </listitem>
          <listitem>
            <para>Create, list, and delete volume snapshots.</para>
          </listitem>
          <listitem>
            <para>Create a volume from a snapshot.</para>
          </listitem>
          <listitem>
            <para>Copy an image to a volume.</para>
          </listitem>
          <listitem>
            <para>Copy a volume to an image.</para>
          </listitem>
          <listitem>
            <para>Clone a volume.</para>
          </listitem>
          <listitem>
            <para>Extend a volume.</para>
          </listitem>
          <listitem>
            <para>Migrate a volume with back-end assistance.</para>
          </listitem>
          <listitem>
            <para>Retype a volume.</para>
          </listitem>
          <listitem>
            <para>Manage and unmanage a volume.</para>
          </listitem>
        </itemizedlist>
  </simplesect>

  <simplesect xml:id="configure-dothill-array">
    <title>Configuring the array</title>

    <procedure>
      <step>
    <para>Verify that the array can be managed via an HTTPS connection. HTTP
    can also be used if <userinput>dothill_api_protocol=http</userinput> is
    placed into the appropriate sections of the
    <filename>cinder.conf</filename> file.</para>

    <para>Confirm that virtual pools A and B are present if you plan to use
    virtual pools for OpenStack storage.</para>

    <para>If you plan to use vdisks instead of virtual pools, create or
    identify one or more vdisks to be used for OpenStack storage;
    typically this will mean creating or setting aside one disk group for each
    of the A and B controllers.</para>
      </step>

      <step>
    <para>Create two entries for storage backends in the
    <filename>cinder.conf</filename> file, one for each storage pool to be
    used with OpenStack. You will need to enter: the appropriate driver name;
    IP address or hostname of the management interface; the username and
    password of an array user account with 'manage' privileges; and the iSCSI
    IP addresses if using the iSCSI transport protocol. This information will
    be repeated in each entry.</para>

    <para>In the examples below, the first two parameter values are different for each
    entry; the <userinput>volume_backend_name</userinput> value should match
    the name of the backend entry, and the
    <userinput>dothill_backend_name</userinput> value must be the name of the
    storage pool or vdisk on the array.</para>
    <example><title>iSCSI example backend entries</title>
<programlisting>[dothill-a]
volume_backend_name = dothill-a
dothill_backend_name = A
volume_driver = cinder.volume.drivers.dothill.dothill_iscsi.DotHillISCSIDriver
san_ip = 10.1.2.3
san_login = manage
san_password = !manage
dothill_iscsi_ips = 10.2.3.4,10.2.3.5

[dothill-b]
volume_backend_name = dothill-b
dothill_backend_name = B
volume_driver = cinder.volume.drivers.dothill.dothill_iscsi.DotHillISCSIDriver
san_ip = 10.1.2.3
san_login = manage
san_password = !manage
dothill_iscsi_ips = 10.2.3.4,10.2.3.5</programlisting></example>
    <example><title>Fibre Channel example backend entries</title>
<programlisting>[dothill-a]
volume_backend_name = dothill-a
dothill_backend_name = A
volume_driver = cinder.volume.drivers.dothill.dothill_fc.DotHillFCDriver
san_ip = 10.1.2.3
san_login = manage
san_password = !manage

[dothill-b]
volume_backend_name = dothill-b
dothill_backend_name = B
volume_driver = cinder.volume.drivers.dothill.dothill_fc.DotHillFCDriver
san_ip = 10.1.2.3
san_login = manage
san_password = !manage</programlisting></example>
      </step>

      <step>
    <para>If any <userinput>volume_backend_name</userinput> value refers
    to a vdisk rather than a virtual pool, add an additional statement
    <userinput>dothill_backend_type = linear</userinput> to that backend
    entry.</para>
      </step>

      <step>
    <para>If HTTPS is not enabled in the array, include
    <userinput>dothill_api_protocol = http</userinput> in each of the
    entries.</para>
      </step>
      <step>
        <para>If HTTPS is enabled, you can enable certificate
        verification with the option
        <userinput>dothill_verify_certificate=True</userinput>.  You may
        also use the
        <userinput>dothill_verify_certificate_path</userinput> parameter
        to specify the path to a CA_BUNDLE file containing CAs other than
        those in the default list.</para>
      </step>
      <step>
        <para>Modify the <userinput>[DEFAULT]</userinput> section of the
        <filename>cinder.conf</filename> file to reference the two
        backend entries, editing the
        <userinput>default_volume_type</userinput> and
        <userinput>enabled_backends</userinput> parameters:</para>
        <example><title>[DEFAULT] section changes</title>
        <programlisting>[DEFAULT]
  ...
default_volume_type = dothill-a
enabled_backends = dothill-a,dothill-b
  ...</programlisting></example>
      </step>
      <step>
        <para>After modifying <filename>cinder.conf</filename>, restart
        the <systemitem class="service">cinder-volume</systemitem>
        service.</para>
      </step>
    </procedure>
  </simplesect>
  <simplesect xml:id="dothill-specific-options">
    <title>Driver-specific options</title>
    <para>The following table contains the configuration options that are specific to the
Dot Hill drivers.</para>
    <xi:include href="../../../common/tables/cinder-dothill.xml"/>
  </simplesect>
</section>
